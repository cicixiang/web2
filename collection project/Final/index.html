<!DOCTYPE HTML>
<html lang="en">

<head>
	<meta charset="UTF-8">
  	<title>CiCi's website'</title>
	<script src='https://code.jquery.com/jquery-2.1.3.min.js'></script>
  	<script src='packery.pkgd.min.js'></script>
  	<script src='tabletop.js'></script>
  	<script src='collection.js'></script>
	<script src='menu.js'></script>	
	<link type='text/css' rel='stylesheet' href='style.css' />
	<link type='text/css' rel='stylesheet' href='menu.css' />
</head>

<body>
	<div id='filter-bar-wrapper'>
		<nav>
		<b class='bigtitle' align=“center”>Photograph Collection</b>
		</nav>
		<div id='search-bar'>
			<input type='text' id='search' placeholder='search'/>
		</div>
		
		<div id='filter-bar'>
  
			<ul id="nav">
				<li><a href="#" data-category="" data-countrycate="" class='category countrycate selected' id="all-button">All</a></li>
				
		        <li><a href="#">Year</a>
		            <ul>
		                <li><a href="#" data-category="2012" class='category'>2012</a></li>
		                <li><a href="#" data-category="2013" class='category'>2013</a></li>
		                <li><a href="#" data-category="2014" class='category'>2014</a></li>
					</ul>
				</li>
				
		        <li><a href="#">Country</a>
					
					
					
		            <ul>
		                <li><a href="#" data-countrycate="France" class='countrycate'>France</a></li>
		                <li><a href="#" data-countrycate="Germany" class='countrycate'>Germany</a></li>
		                <li><a href="#" data-countrycate="Italy" class='countrycate'>Italy</a></li>
		                <li><a href="#" data-countrycate="Maldives" class='countrycate'>Maldives</a></li>
		                <li><a href="#" data-countrycate="Switzerland" class='countrycate'>Switzerland</a></li>
		            </ul>
		        </li>
				
				<li><a href="#">Sort</a>
					<ul>
						<li><a href="#"  data-order='category' class="order">By year</a></li>
						<li><a href="#"  data-order="title" class="order">By country</a></li>
					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<ul class='collection'>
		
	</ul>

	<div class='overlay'></div>
	<div class='modal'></div>
	
<!--************** java script *****************-->	
<script>
	
	function showModal(item) {
		$(".modal").empty();
   
		var $h1 = $("<h1>").text(item.country);
		var $img = $("<img>").attr("src",item.pic);
		var $p = $("<p>").text(item.country);

		$(".modal").append($h1,$img,$p);
   
		$(".overlay").show();
		$(".modal").show();

	}

	function hideModal() {
		$(".overlay").hide();
		$(".modal").hide();
	}

/**********************************/
/**** add table data into $li *****/
/**********************************/
	
	function addItem(item) {
	 /* var $li = $("<li>").addClass("item").addClass(item.Color.toLowerCase()); */
		var $li = $("<li>").addClass("item");

	  	$li.attr("data-category",item.year);
		$li.attr("data-countrycate",item.country);

		var $pic = $("<img>").attr("src",item.pic);
	  	var $h2 = $("<h2 class='name'>").text(item.country);

	  	$li.append($pic);

	  	$li.on("click",function(e) {
	    	showModal(item);
	  	});

	  	$(".collection").append($li);
	};


	function addItems(data) {
		for(var i=0;i<data.length;i++) {
			addItem(data[i]);
	  	}
	}

/***********************************************/
/***** Extract data from Google Spreadsheet ****/
/***********************************************/
	function callback(data) { 

		addItems(data);

		var $container = $('.collection');
		$container.packery({
			itemSelector: '.item',
			gutter: 10,
		});

		var myCollection = $(".item").collection({
			filters: { 
				"title": "h2",
				"category": "[data-category]",
				"countrycate": "[data-countrycate]"
			},

			update: function() { 
				$container.packery(); 
				setTimeout(function() { $container.packery()},600);
			},
			ordered: function() {
				$container.packery('reloadItems');
 			   console.log("Whoa");
		   },
		   hide: function($elem) { $elem.hide(); },
		   show: function($elem) { $elem.fadeIn(500); },
	   });

	   $(".category").on("click",function(e) {
		   var category = $(this).data("category");
		   $("#filter-bar a.category").removeClass("selected");
		   $(this).addClass("selected");
		   myCollection.filtered("category",category);
	   });
	   
	   $(".countrycate").on("click",function(e) {
		   var countrycate = $(this).data("countrycate");
		   $("#filter-bar a.countrycate").removeClass("selected");
		   $(this).addClass("selected");
		   myCollection.filtered("countrycate",countrycate);
	   });


	   $(".order").on("click",function(e) {
		   var order = $(this).data("order");
		   $("#filter-bar a.category").removeClass("selected");
		   $(this).addClass("selected");
		   myCollection.ordered(order);
	   });



	   $("#search").on("change keyup",function(e) {
		   myCollection.filtered("title", $(this).val());
	   });

	   $(".overlay").on("click",function(e) {
		   hideModal();
	   });

}

	Tabletop.init( { key: "https://docs.google.com/spreadsheets/d/17ue5H0-U-qKU4whmwhbQZtP3V3KyuCAvxYubWld48qI/pubhtml",
                   callback: callback,
                   simpleSheet: true } )


</script>
	
</body>
</html>
