<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Collection Exercise</title>
  <script src='https://code.jquery.com/jquery-2.1.3.min.js'></script>
  <script src='http://cykod.github.io/Collection.js/packery.pkgd.min.js'></script>
  <script src='http://cykod.github.io/Collection.js/tabletop.js'></script>
  <script src='collection.js'></script>
  <link type='text/css' rel='stylesheet' href='style.css' />
</head>
<body>

	<!--div id='filter-bar-wrapper'-->
		<div id='filter-bar'>
			<input type='text' id='search' placeholder='search'/>
    		<button data-category=""      class='category selected' id="all-button">All</button>
			<button data-category="Bird"   class='category'>bird</button>
			<button data-category="Cat"   class='category'>cat</button>
			<button data-category="Dog"   class='category'>dog</button>
			<button data-category="Rabbit"   class='category'>rabbit</button>
		</div>
	<!--/div-->

	<ul class='collection'> 
		
	</ul>

	<div class='overlay'></div>
	
	<div class='modal'></div>


<script>
	
/************ Add in Detail View  ***************/
	function showModal(item) {
		$(".modal").empty();
		
		var $h1 = $("<h1>").text(item.Name);
		var $img = $("<img>").attr("src",item.Image);
		var $p = $("<p>").text(item.Bio);
		
		$(".modal").append($h1,$img,$p);
		$(".overlay").show();
		$(".modal").show();

	}


	function hideModal() {
		$(".overlay").hide();
		$(".modal").hide();
	}
	
/************ Draw List View ************/
	function addItem(item) {
		var $li = $("<li>").addClass("item").addClass(item.Animal);

		$li.attr("data-category",item.Animal);
		

		var $h2 = $("<h2 class='name'>").text(item.Name);  
		var $p = $("<p class='description'>").text(item.Bio);
	
		$li.append($h2,$p);

		$li.on("click",function(e) {
			showModal(item);
		});

		$(".collection").append($li);
	};

	function addItems(data) {

		for(var i=0;i<data.length;i++) {
			addItem(data[i]);
		}
	}	
	
/***** Extract data from Google Spreadsheet ****/
	
	function callback(data) { 

		addItems(data);

		var $container = $('.collection');

		$container.packery({
			itemSelector: '.item',
			gutter: 10
		});

		/************* add in filtering  **************/
		var myCollection = $(".item").collection({
			
			filters: { 
				"title": "h2",
				"category": "[data-category]"
			},
			
			update: function() { 
				$container.packery(); 
				setTimeout(function() { $container.packery()},600);
			},
			
    		hide: function($elem) { $elem.hide(); },
    		
			show: function($elem) { $elem.fadeIn(500); },
		});
		
		$(".category").on("click",function(e) {
			var category = $(this).data("category");
			/*
			$("#filter-bar button").removeClass("selected");
			$(this).addClass("selected");
			*/
			myCollection.filtered("category",category);
		});

		$("#search").on("change keyup",function(e) {
			myCollection.filtered("title", $(this).val());
		});
		/*
		$(".overlay").on("click",function(e) {
			hideModal();
		});
		*/
	}

/*******************************************/
	
	Tabletop.init( { key: "https://docs.google.com/spreadsheets/d/1RjgdfPvprRCI-hMVVWIc2lymPvDiPUjpS-htVJYfDZ4/pubhtml",
                   callback: callback,
                   simpleSheet: true } )








</script>	
</body>
</html>
